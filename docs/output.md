# nf-cmgg/exomecnv: Output

## Introduction

This document describes the output produced by the pipeline.

The directories listed below will be created in the results directory after the pipeline has finished. All paths are relative to the top-level results directory.

<!-- TODO nf-core: Write this documentation describing your workflow's output -->

## Pipeline overview

The pipeline is built using [Nextflow](https://www.nextflow.io/) and processes data using the following steps:

- [Cram Prepare](#cram-prepare)
- [ExomeDepth count](#exomedepth-count)
- [Count merge](#count-merge)
- [ExomeDepth CNV call](#exomedepth-cnv-call)
- [CNV merge](#cnv-merge)
- [BedGoVcf](#bedgovcf)
- [Tabix](#tabix)
- [EnsemblVEP](#ensemblvep)
- [Pipeline information](#pipeline-information) - Report metrics generated during the workflow execution

### Cram Prepare

If CRAM/CRAI files were provided in the samplesheet, they will be converted into BAM/BAI first before continuing with the pipeline.

<details markdown="1">
<summary>Output files</summary>

- `cram/`
  - `<sample>.bam`: BAM file
  - `<sample>.bam.bai`: BAI index file
</details>

### ExomeDepth count

ExomeDepth will generate 2 count files for each sample: 1 for autosomal chromosomes and 1 for chrX.

<details markdown="1">
<summary>Output files</summary>

- `exomedepth/`
  - `counts/`
    - `<sample>_autosomal.txt`: Count file for autosomal chromosomes per sample
    - `<sample>_chrX.txt`: Count file for chrX per sample

</details>

### Count merge

All samples sharing the same pool will be merged together since CNV calling in the ExomeDepth workflow is executed per pool.

<details markdown="1">
<summary>Output files</summary>

- `exomedepth/`
  - `counts/`
    - `<pool>_autosomal.txt`: Count file for autosomal chromosomes per pool
    - `<pool>_chrX.txt`: Count file for chrX per pool

</details>

### ExomeDepth CNV call

ExomeDepth will generate 2 CNV files for each sample: 1 for autosomal chromosomes and 1 for chrX.

<details markdown="1">
<summary>Output files</summary>

- `exomedepth/`
  - `cnv_call/`
    - `<sample>_CNVs_ExomeDepth_autosomal.txt`: CNV file for autosomal chromosomes
    - `<sample>_CNVs_ExomeDepth_chrX.txt`: CNV file for chrX


</details>

### CNV merge

The 2 CNV files will be merged into 1 complete file.

<details markdown="1">
<summary>Output files</summary>

- `exomedepth/`
  - `cnv_call/`
    - `<sample>_CNVs_ExomeDepth.txt`: Merged CNV file

</details>

### BedGoVcf

The merged CNV file is converted into a VCF file.

<details markdown="1">
<summary>Output files</summary>

- `exomedepth/`
  - `cnv_call/`
    - `<sample>_CNVs_ExomeDepth.vcf.gz`: VCF file

</details>

### Tabix

A TBI index file is generated for each VCF file. While these TBI index files are optional for EnsemblVEP, we still generate them as a best practice to ensure better performance and reliability.

<details markdown="1">
<summary>Output files</summary>

- `exomedepth/`
  - `cnv_call/`
    - `<sample>_CNVs_ExomeDepth.vcf.gz.tbi`: TBI index file

</details>

### EnsemblVEP

<details markdown="1">
<summary>Output files</summary>

- `vep/`
  - `<sample>.vep.vcf.gz`: VEP annotated file

</details>

### Pipeline information

<details markdown="1">
<summary>Output files</summary>

- `pipeline_info/`
  - Reports generated by Nextflow: `execution_report.html`, `execution_timeline.html`, `execution_trace.txt` and `pipeline_dag.dot`/`pipeline_dag.svg`.
  - Reports generated by the pipeline: `pipeline_report.html`, `pipeline_report.txt` and `software_versions.yml`. The `pipeline_report*` files will only be present if the `--email` / `--email_on_fail` parameter's are used when running the pipeline.


</details>

\
[Nextflow](https://www.nextflow.io/docs/latest/tracing.html) provides excellent functionality for generating various reports relevant to the running and execution of the pipeline. This will allow you to troubleshoot errors with the running of the pipeline, and also provide you with other information such as launch commands, run times and resource usage.
